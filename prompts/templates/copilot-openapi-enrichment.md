# OpenAPI仕様書拡充プロンプト（GitHub Copilot用）

## 使い方

このプロンプトは、GitHub Copilot Chatで既存のOpenAPI仕様書を拡充するために最適化されています。

### GitHub Copilot Chatでの使用手順

1. **Copilot Chatを開く**
   - VSCodeで `Ctrl+Shift+I` (Windows/Linux) または `Cmd+Shift+I` (Mac)
   - または、サイドバーのCopilotアイコンをクリック

2. **このプロンプトを使用**
   - 以下の「プロンプトテンプレート」をコピー
   - OpenAPI仕様書を `[ここにOpenAPI仕様書を貼り付け]` の部分に貼り付け
   - Copilot Chatに入力して送信

3. **結果を確認**
   - Copilotが拡充された仕様書を生成
   - 必要に応じて追加の質問や修正依頼が可能

---

## プロンプトテンプレート

```
以下のOpenAPI仕様書をもとに、ユースケース中心の詳細なAPI仕様書を作成してください。

### 要求事項

1. **API全体概要**
   - システムの目的を説明
   - 想定ユースケースを列挙
   - 各ユースケースのAPI呼び出し手順を順序付きで記載

2. **API詳細仕様**（各APIについて）
   - 概要: APIが果たす目的
   - 用語定義: 専門用語の説明
   - リクエスト仕様: メソッド、パラメータ、ボディ
   - レスポンス仕様: 成功/エラーレスポンス例
   - 関連API・利用手順: 前後に呼び出すAPI、IDの取得元

3. **出力形式**
   - Markdown形式
   - 見出し、リスト、コードブロックを適切に使用

### OpenAPI仕様書

```yaml
[ここにOpenAPI仕様書を貼り付け]
```

### 生成例

以下のような形式で生成してください：

```markdown
# [API名] 仕様書

## 1. API全体概要

### システムの目的
[システムの目的を記載]

### 想定ユースケース

#### ユースケース1: [ユースケース名]
1. [API名]（[メソッド] [パス]）
   - [簡単な説明]
2. [API名]（[メソッド] [パス]）
   - [簡単な説明]

## 2. API詳細仕様

### [summary]（[メソッド] [パス]）

#### 概要
[APIの目的を具体的に説明]

#### 用語定義
- **用語1**: 定義
- **用語2**: 定義

#### リクエスト仕様
- メソッド: [メソッド]
- エンドポイント: [パス]
- パラメータ:
  - [パラメータ名]: [型] - [説明]

#### レスポンス仕様

成功時（200）:
\`\`\`json
{
  "field": "value"
}
\`\`\`

エラー時（400）:
\`\`\`json
{
  "error": "message"
}
\`\`\`

#### 関連API・利用手順
- 事前に [API名]（[メソッド] [パス]）を呼び出してください
- このAPIで取得した[フィールド名]を使って [API名] を呼び出します
```
```

---

## 簡易版プロンプト

より簡潔に使いたい場合は、以下のプロンプトを使用してください：

```
このOpenAPI仕様書をユースケース中心に拡充してください。以下を含めてください：
1. API呼び出し手順
2. 専門用語の定義
3. API間の関連性

[OpenAPI仕様書をここに貼り付け]
```

---

## ユースケース別のプロンプト例

### 例1: 全体的な拡充

```
以下のOpenAPI仕様書を、API利用者が理解しやすいように拡充してください。
特に、ユースケースごとのAPI呼び出し手順と、専門用語の定義を含めてください。

[OpenAPI仕様書]
```

### 例2: 特定のエンドポイントにフォーカス

```
以下のOpenAPI仕様書から、[エンドポイント名]について詳しく説明してください。
関連するAPIとの関係性や、利用手順を含めてください。

[OpenAPI仕様書]
```

### 例3: ユースケースの抽出

```
以下のOpenAPI仕様書から、主要なユースケースを3つ抽出し、
それぞれのAPI呼び出し手順を説明してください。

[OpenAPI仕様書]
```

---

## GitHub Copilotでの対話例

### 初回のプロンプト
```
User: このOpenAPI仕様書をユースケース中心に拡充してください
[OpenAPI仕様書を貼り付け]

Copilot: 承知しました。OpenAPI仕様書を分析して、
ユースケース中心の詳細な仕様書を生成します...

# E-Commerce API 仕様書

## 1. API全体概要
...
```

### フォローアップ質問
```
User: 「商品購入」のユースケースをもっと詳しく説明してください

Copilot: 商品購入のユースケースを詳細化します...

#### ユースケース: 商品を購入する

1. **ユーザー認証API**（POST /auth/login）
   - ユーザーのメールアドレスとパスワードで認証
   - アクセストークンを取得（以降のAPIで使用）
   
2. **商品一覧取得API**（GET /items）
   ...
```

### 追加の改善依頼
```
User: 各APIの用語定義をもっと詳しくしてください

Copilot: 各APIの用語定義を拡充します...

#### 用語定義
- **アクセストークン**: 認証済みユーザーのセッションを識別する文字列。
  JWTフォーマットで、有効期限は24時間。すべての認証が必要なAPIで使用。
...
```

---

## Tips

### 1. OpenAPI仕様書の準備
- 完全なOpenAPI 3.0仕様書が望ましい
- 最低限、`paths`と各エンドポイントの`summary`が必要

### 2. より良い結果を得るために
- OpenAPI仕様書に`description`を充実させておく
- 業務ドメイン固有の用語がある場合は、事前に説明を追加
- タグを使ってエンドポイントを分類しておく

### 3. 段階的な拡充
- まず全体概要を生成
- 次に特定のエンドポイントを詳細化
- 最後にユースケースを追加

### 4. Copilotとの対話
- 最初のプロンプトで全てを求めない
- 生成された内容を確認しながら、段階的に詳細化を依頼
- 「もっと詳しく」「例を追加」などの追加指示が有効

---

## トラブルシューティング

### 問題: 生成される仕様書が不完全

**解決策:**
```
User: 以下の点を追加してください：
1. 各エンドポイントの用語定義
2. API呼び出しの前後関係
3. エラーレスポンスの例
```

### 問題: ユースケースが抽出されない

**解決策:**
```
User: 以下のユースケースについて、API呼び出し手順を説明してください：
- ユーザー登録から初回ログインまで
- 商品の検索から購入まで
- 注文履歴の確認
```

### 問題: 専門用語の説明が不足

**解決策:**
```
User: 以下の用語について、より詳しい定義を追加してください：
- アクセストークン
- SKU
- セッション
```

---

## 参考資料

- メインテンプレート: `prompts/templates/openapi-enrichment.md`
- 使用例: `prompts/examples/ecommerce-openapi-enrichment.md`
- GitHub Copilot指示書: `.github/copilot-instructions.md`

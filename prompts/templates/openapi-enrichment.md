# REST API仕様書 拡充指示

以下のOpenAPI仕様書（YAMLまたはJSON形式）をもとに、説明内容が充実したAPI仕様書を作成してください。

---

## 🎯 目的

このドキュメントの目的は、**API利用者がAPIの構造・意味・利用手順を明確に理解できる仕様書を生成すること**です。  
単なるリファレンスではなく、**ユースケース中心・手順中心のドキュメント**としてください。

---

## 🧩 出力構成

出力は以下の構成で生成してください。

### 1. API全体概要
- システム全体の目的や想定ユースケースをわかりやすく説明する。
- 想定ユースケースごとに、どのAPIをどの順番で呼び出すかを**手順として列挙**する。
  - 各手順にはAPI名（`summary`の値）とHTTPメソッド＋エンドポイントを併記する。
  - 可能であれば簡単なリクエスト／レスポンス例を示す。

**例：**
```
ユースケース：ユーザーが商品を購入する場合
1. ユーザー情報取得API（GET /users/{id}）
2. 商品一覧取得API（GET /items）
3. カート追加API（POST /cart）
4. 購入確定API（POST /orders）
```

---

### 2. API詳細仕様
APIごとに以下の情報をまとめる。

#### フォーマット

**{summary}（{HTTPメソッド} {path}）**

##### 概要
このAPIが果たす目的を具体的に説明する。

専門用語が登場する場合は、「用語定義」で定義する。

##### 用語定義
各パラメータ・レスポンス項目に含まれる専門用語をリストアップし、簡潔に定義する。

例：
- **トークン** = 認証済みユーザーのセッション識別子
- **SKU** = Stock Keeping Unit（在庫管理単位）

##### リクエスト仕様
- メソッド・エンドポイント
- パスパラメータ・クエリパラメータ・リクエストボディの構造（必要に応じて例示）
- 必須パラメータと任意パラメータの明確な区別

##### レスポンス仕様
- レスポンス形式（JSONなど）
- 代表的な成功レスポンスとエラーレスポンスの例
- 各フィールドの意味と型

##### 関連API・利用手順
このAPIを呼び出す前後に利用すべきAPIを明記する。

**特にID指定APIの場合は重要**：
- どのAPIでIDを取得するか
- このAPIで取得した情報を使って次にどのAPIを呼ぶか

例：
```
このAPIで取得したuser_idを使って GET /users/{id}/orders を呼び出します。
商品を購入する場合は、事前に POST /auth/login で認証トークンを取得してください。
```

---

## 🧠 生成方針

1. **OpenAPI仕様の活用**
   - OpenAPI仕様の `summary`、`description`、`parameters`、`responses` の内容を最大限活用する
   - 各エンドポイントのタグやoperationIdから関連性を推測する

2. **説明の補強**
   - 説明が足りない箇所は、一般的なREST API設計の知見を補完的に使って説明を補強する
   - ビジネスロジックが推測できる場合は、その文脈を追加する

3. **フォーマット**
   - ドキュメントはMarkdown形式で出力し、見出し・リスト・コードブロックを適切に使う
   - 各用語の定義はなるべく簡潔かつ業務ドメインに即した形で記載する

4. **API間の関連性**
   - 「IDを指定して呼び出すAPI」については、関連する取得・作成・更新APIを紐づけて説明する
   - リソースの作成→取得→更新→削除のライフサイクルを明確にする

5. **実用性の重視**
   - 実際の利用シーンを想定した説明を心がける
   - エラーケースや注意点も明記する

---

## 📦 入力データ

以下にOpenAPI仕様書をYAMLまたはJSON形式で埋め込んでください。

```yaml
# OpenAPI Specification
# (openapi.yaml または openapi.json の内容をここに貼り付け)

[OpenAPI仕様書をここに貼り付けてください]
```

---

## 🏁 出力形式

最終出力はMarkdown形式の仕様書として、以下の構成順で作成すること。

1. **API全体概要**
   - システムの目的
   - 想定ユースケース一覧
   - 各ユースケースの呼び出し手順

2. **各APIの詳細仕様**
   - summary順またはカテゴリ（タグ）順
   - 各APIに対して上記フォーマットに従った詳細説明

3. **付録（必要に応じて）**
   - 共通エラーコード一覧
   - 認証・認可の詳細
   - レート制限などの制約事項

---

## 💡 補足

このテンプレートを使うことで、AIは：
- OpenAPI仕様の構造を理解しながら
- 用語定義を補完
- ID指定APIの利用文脈を説明
- ユースケースごとの手順を生成

できるようになります。

---

## 使用例

### 入力するOpenAPI仕様の例

```yaml
openapi: 3.0.0
info:
  title: E-Commerce API
  version: 1.0.0
paths:
  /users/{id}:
    get:
      summary: ユーザー情報取得
      description: 指定したIDのユーザー情報を取得します
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 成功
  /items:
    get:
      summary: 商品一覧取得
      description: 商品の一覧を取得します
      responses:
        '200':
          description: 成功
```

### 期待される出力の例

```markdown
# E-Commerce API 仕様書

## 1. API全体概要

### システムの目的
このAPIは、ECサイトにおける商品閲覧から購入までの一連の機能を提供します。

### 想定ユースケース

#### ユースケース1: 商品を閲覧する
1. 商品一覧取得API（GET /items）
2. 商品詳細取得API（GET /items/{id}）

#### ユースケース2: 商品を購入する
1. ユーザー認証API（POST /auth/login）
2. 商品一覧取得API（GET /items）
3. ユーザー情報取得API（GET /users/{id}）
4. カート追加API（POST /cart）
5. 購入確定API（POST /orders）

## 2. API詳細仕様

### ユーザー情報取得（GET /users/{id}）

#### 概要
指定したユーザーIDに対応するユーザーの詳細情報を取得します。
このAPIは認証済みユーザーのみが利用可能です。

#### 用語定義
- **ユーザーID**: システム内でユーザーを一意に識別する文字列

#### リクエスト仕様
- メソッド: GET
- エンドポイント: /users/{id}
- パスパラメータ:
  - id (string, 必須): ユーザーID

#### レスポンス仕様
成功時（200）:
```json
{
  "id": "user123",
  "name": "山田太郎",
  "email": "yamada@example.com"
}
```

#### 関連API・利用手順
- 事前に POST /auth/login で認証を行い、トークンを取得してください
- 取得したuser_idを使って GET /users/{id}/orders で注文履歴を確認できます
```
